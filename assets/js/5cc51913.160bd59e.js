"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2757],{3905:function(e,t,a){a.d(t,{Zo:function(){return p},kt:function(){return u}});var n=a(7294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var l=n.createContext({}),d=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},p=function(e){var t=d(e.components);return n.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),m=d(a),u=i,h=m["".concat(l,".").concat(u)]||m[u]||c[u]||r;return a?n.createElement(h,o(o({ref:t},p),{},{components:a})):n.createElement(h,o({ref:t},p))}));function u(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,o=new Array(r);o[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var d=2;d<r;d++)o[d]=a[d];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},5111:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return d},toc:function(){return p},default:function(){return m}});var n=a(7462),i=a(3366),r=(a(7294),a(3905)),o=["components"],s={title:"Spring Starter",sidebar_position:10},l=void 0,d={unversionedId:"spring-starter",id:"spring-starter",isDocsHomePage:!1,title:"Spring Starter",description:"|Lecture equivalent| Duration |",source:"@site/tasks/spring-starter.md",sourceDirName:".",slug:"/spring-starter",permalink:"/swdt/tasks/spring-starter",editUrl:"https://github.com/nds-swe/swdt/edit/main/tasks/spring-starter.md",tags:[],version:"current",lastUpdatedBy:"mambax",lastUpdatedAt:1649406819,formattedLastUpdatedAt:"4/8/2022",sidebarPosition:10,frontMatter:{title:"Spring Starter",sidebar_position:10},sidebar:"myAutogeneratedSidebar",previous:{title:"Integration Testing",permalink:"/swdt/tasks/integration-testing"},next:{title:"Strategy Pattern",permalink:"/swdt/tasks/strategy-pattern"}},p=[{value:"Spring",id:"spring",children:[],level:2},{value:"Starter App",id:"starter-app",children:[{value:"Run",id:"run",children:[],level:3}],level:2},{value:"Adding and securing endpoints",id:"adding-and-securing-endpoints",children:[{value:"Adding an insecure REST endpoint",id:"adding-an-insecure-rest-endpoint",children:[],level:3},{value:"Adding a to-be secure REST endpoint",id:"adding-a-to-be-secure-rest-endpoint",children:[],level:3},{value:"Securing an endpoint",id:"securing-an-endpoint",children:[],level:3}],level:2},{value:"Recap",id:"recap",children:[],level:2},{value:"Building docker",id:"building-docker",children:[],level:2},{value:"Push",id:"push",children:[],level:2},{value:"Dependabot",id:"dependabot",children:[],level:2}],c={toc:p};function m(e){var t=e.components,s=(0,i.Z)(e,o);return(0,r.kt)("wrapper",(0,n.Z)({},c,s,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Metadata")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("table",{parentName:"div"},(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Lecture equivalent"),(0,r.kt)("th",{parentName:"tr",align:null},"Duration"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"5"),(0,r.kt)("td",{parentName:"tr",align:null},"3h 45min")))),(0,r.kt)("p",{parentName:"div"},"At the end of this task, students"),(0,r.kt)("ul",{parentName:"div"},(0,r.kt)("li",{parentName:"ul"},"have setup a spring starter app"),(0,r.kt)("li",{parentName:"ul"},"have added a secured endpoint to their starter"),(0,r.kt)("li",{parentName:"ul"},"have built a container image with their starter within"),(0,r.kt)("li",{parentName:"ul"},"have checked all of the above into git"),(0,r.kt)("li",{parentName:"ul"},"have (optionally) added a Dependabot Config to their starter")))),(0,r.kt)("p",null,"In the class you have cloned a the pre-made starter ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/nds-swe/spring-starter"},"nds-swe/spring-starter"),"."),(0,r.kt)("p",null,"To create this starter the following steps have been performed:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Use ",(0,r.kt)("a",{parentName:"li",href:"https://start.spring.io/"},"start.spring.io")," to create the Web Application template. Note that you can add the ",(0,r.kt)("inlineCode",{parentName:"li"},"Spring Web")," dependency there already."),(0,r.kt)("li",{parentName:"ol"},"Glance into these ",(0,r.kt)("a",{parentName:"li",href:"https://spring.io/guides/gs/spring-boot/"},"1"),", ",(0,r.kt)("a",{parentName:"li",href:"https://www.jetbrains.com/help/idea/your-first-spring-application.html#what-next"},"2")," tutorials to learn the basics.")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"start.spring.io",src:a(6574).Z})),(0,r.kt)("small",null,"Caution, images are not from code, they might get deprecated!"),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Task")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Invest into your own starter! Clearly you can just take the sample and claim it yours \ud83d\udc7a, but, how much will you have learned about dependencies, annotations and Spring then?"))),(0,r.kt)("h2",{id:"spring"},"Spring"),(0,r.kt)("p",null,"You can read a ",(0,r.kt)("a",{parentName:"p",href:"/docs/tools/spring"},"small introduction to Spring from the NDS side")," in the tools section."),(0,r.kt)("h2",{id:"starter-app"},"Starter App"),(0,r.kt)("p",null,"In the lecture we have analysed the application once already. A key skill of an engineer is to be able to dive into someone elses code."),(0,r.kt)("p",null,"The starter (also the freshly downloaded one from ",(0,r.kt)("a",{target:"_blank",href:a(8602).Z},"start.spring.io"),") contains the following files (shortened for brevity):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},".\n\u251c\u2500\u2500 build.gradle\n\u251c\u2500\u2500 gradle\n\u2502\xa0\xa0 \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 ... more gradle stuff\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 main\n    \u2502\xa0\xa0 \u251c\u2500\u2500 java\n    \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 ch\n    \u2502\xa0\xa0 \u2502\xa0\xa0     \u2514\u2500\u2500 abbts\n    \u2502\xa0\xa0 \u2502\xa0\xa0         \u2514\u2500\u2500 nds\n    \u2502\xa0\xa0 \u2502\xa0\xa0             \u2514\u2500\u2500 swe\n    \u2502\xa0\xa0 \u2502\xa0\xa0                 \u2514\u2500\u2500 swdt\n    \u2502\xa0\xa0 \u2502\xa0\xa0                     \u2514\u2500\u2500 starter\n    \u2502\xa0\xa0 \u2502\xa0\xa0                         \u2514\u2500\u2500 StarterApplication.java\n    \u2502\xa0\xa0 \u2514\u2500\u2500 resources\n    \u2502\xa0\xa0     \u251c\u2500\u2500 application.properties\n    \u2502\xa0\xa0     \u2514\u2500\u2500 ...\n    \u2514\u2500\u2500 test\n        \u2514\u2500\u2500 java\n            \u2514\u2500\u2500 ch\n                \u2514\u2500\u2500 abbts\n                    \u2514\u2500\u2500 nds\n                        \u2514\u2500\u2500 swe\n                            \u2514\u2500\u2500 swdt\n                                \u2514\u2500\u2500 starter\n                                    \u2514\u2500\u2500 StarterApplicationTests.java\n")),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Task")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Understand the content of the following files "),(0,r.kt)("ul",{parentName:"div"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"StarterApplication.java")," in parent directory ",(0,r.kt)("inlineCode",{parentName:"li"},"src/main")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"StarterApplicationTests.java")," in parent directory ",(0,r.kt)("inlineCode",{parentName:"li"},"src/main")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"build.gradle")," in ",(0,r.kt)("inlineCode",{parentName:"li"},"."))),(0,r.kt)("p",{parentName:"div"},"With understand it is meant that you actually know for ",(0,r.kt)("strong",{parentName:"p"},"each")," line what it does and why it exists."),(0,r.kt)("p",{parentName:"div"},"You find a sample solution in the next task."))),(0,r.kt)("h3",{id:"run"},"Run"),(0,r.kt)("p",null,"If your app runs smoothly, you should see something like:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"2021-04-03 21:01:04.048  INFO 64739 --- [main] c.a.n.s.swdt.starter.StarterApplication  : Starting StarterApplication using Java 14.0.2 on C02Y91DDJGH6 with PID 64739 (/Users/i511895/SAPDevelop/abb/spring-starter/build/classes/java/main started by i511895 in /Users/i511895/SAPDevelop/abb/spring-starter)\n2021-04-03 21:01:04.051  INFO 64739 --- [main] c.a.n.s.swdt.starter.StarterApplication  : No active profile set, falling back to default profiles: default\n2021-04-03 21:01:04.743  INFO 64739 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)\n2021-04-03 21:01:04.752  INFO 64739 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]\n2021-04-03 21:01:04.752  INFO 64739 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.44]\n2021-04-03 21:01:04.802  INFO 64739 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext\n2021-04-03 21:01:04.802  INFO 64739 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 705 ms\n2021-04-03 21:01:04.934  INFO 64739 --- [main] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'applicationTaskExecutor'\n2021-04-03 21:01:05.073  INFO 64739 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''\n2021-04-03 21:01:05.080  INFO 64739 --- [main] c.a.n.s.swdt.starter.StarterApplication  : Started StarterApplication in 1.398 seconds (JVM running for 1.93)\n")),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Task")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Study this log, line by line and reflect what these messages signal!"),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Sample solution"),(0,r.kt)("a",{href:"https://github.com/nds-swe/spring-starter/releases/tag/sample-solution-1.0.0",target:"_blank"},"Sample solution")))),(0,r.kt)("h2",{id:"adding-and-securing-endpoints"},"Adding and securing endpoints"),(0,r.kt)("p",null,"In order to secure your endpoint you now need to start reading the code and understand what it tries to do."),(0,r.kt)("div",{className:"admonition admonition-danger alert alert--danger"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"danger")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"This code is miles apart from what you did in the first semester in ALG and OOP. Chances that you meet simple and literally trivial code in production are super small.\nTry to understand the engineering approaches taken or visit any of the communities!"))),(0,r.kt)("h3",{id:"adding-an-insecure-rest-endpoint"},"Adding an insecure REST endpoint"),(0,r.kt)("p",null,"It is a rare occasion that I write tutorials myself due to the danger of deprecation. As securing a REST API is a monstrous topic, I break it down into a few bits to consume. The official guidance would be on ",(0,r.kt)("a",{parentName:"p",href:"https://spring.io/guides/tutorials/rest/"},"spring.io/guides"),"."),(0,r.kt)("p",null,"The app above does not yet feature any endpoint, it is an empty framework. Let us add one."),(0,r.kt)("p",null,"Create a file ",(0,r.kt)("inlineCode",{parentName:"p"},"ch/abbts/nds/swe/swdt/starter/EmployeesController.java")," and add the following content:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package ch.abbts.nds.swe.swdt.starter;\n\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\nimport java.util.Arrays;\nimport java.util.List;\n\n@RestController\n@RequestMapping(path = "/employees")\npublic class EmployeesController {\n  @GetMapping(path = "/", produces = "application/json")\n  public List<String> employees() {\n    return Arrays.asList(new String[]{\n        "Tenzing Norgay",\n        "Edmund Hillary",\n        "These names",\n        "should never be available",\n        "to anonymous users!"\n    });\n  }\n}\n')),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Task")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Investigate this file using Google and answer the following four control questions:"),(0,r.kt)("ul",{parentName:"div"},(0,r.kt)("li",{parentName:"ul"},"What does ",(0,r.kt)("inlineCode",{parentName:"li"},"@RestController")," do?"),(0,r.kt)("li",{parentName:"ul"},"What will be the answer when calling ",(0,r.kt)("inlineCode",{parentName:"li"},"GET /employees/")," and why?"),(0,r.kt)("li",{parentName:"ul"},"Why is the response a ",(0,r.kt)("inlineCode",{parentName:"li"},"Arrays.asList"),"?"),(0,r.kt)("li",{parentName:"ul"},"Does Spring still work, if you name the file ",(0,r.kt)("inlineCode",{parentName:"li"},"MyController1.java"),"? If yes, why?")))),(0,r.kt)("p",null,"As we said, understanding this requires advanced skills, many of them we will learn later in this lecture!"),(0,r.kt)("h3",{id:"adding-a-to-be-secure-rest-endpoint"},"Adding a to-be secure REST endpoint"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'...\n@RestController\n@RequestMapping(path = "/employees-secure")\n...\n')),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Task")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Repeat the previous step but intend the endpoint to become secure! "),(0,r.kt)("p",{parentName:"div"},(0,r.kt)("strong",{parentName:"p"},"In practise we do not name any endpoint ",(0,r.kt)("inlineCode",{parentName:"strong"},"secure"),", this is just for the first time and for the demo!")," There are only very few endpoints ever to be made public (e.g. a version info endpoint)."))),(0,r.kt)("p",null,"We will now secure this endpoint!"),(0,r.kt)("h3",{id:"securing-an-endpoint"},"Securing an endpoint"),(0,r.kt)("p",null,"Create a new file ",(0,r.kt)("inlineCode",{parentName:"p"},"ch/abbts/nds/swe/swdt/starter/CustomWebSecurityConfigurerAdapter.java"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java",metastring:"{9,10,11,12,13,20}","{9,10,11,12,13,20}":!0},'// package and imports omitted for brevity\n@Configuration\n@EnableWebSecurity\npublic class CustomWebSecurityConfigurerAdapter extends WebSecurityConfigurerAdapter {\n  @Override\n  protected void configure(HttpSecurity http) throws Exception {\n    http\n        .csrf().disable()\n        .authorizeRequests()\n        .antMatchers("/employees/**").permitAll()\n        .anyRequest().authenticated()\n        .and()\n        .httpBasic();\n  }\n\n  @Bean\n  @Override\n  public UserDetailsService userDetailsService() {\n    UserDetails user =\n        User.withDefaultPasswordEncoder()\n            .username("user")\n            .password("password")\n            .roles("USER")\n            .build();\n\n    return new InMemoryUserDetailsManager(user);\n  }\n}\n')),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Task")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Secure the endpoint as described above. Answer the following questions carefully:"),(0,r.kt)("ul",{parentName:"div"},(0,r.kt)("li",{parentName:"ul"},"Why does IntelliJ cross out this word (the highlighted line)?")),(0,r.kt)("p",{parentName:"div"},(0,r.kt)("img",{alt:"deprecated-method",src:a(9206).Z})),(0,r.kt)("ul",{parentName:"div"},(0,r.kt)("li",{parentName:"ul"},"What do the highlighted lines do?")),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Sample solution"),(0,r.kt)("a",{href:"https://github.com/nds-swe/spring-starter/releases/tag/0.1.1",target:"_blank"},"Sample solution")))),(0,r.kt)("h2",{id:"recap"},"Recap"),(0,r.kt)("p",null,"Until now we have finished our spring app (with the web plugin) and added an insecure and a secure endpoint to it. We did this with a starter and 3 new files. We reuse what others do best and have produced a nearly ",(0,r.kt)("strong",{parentName:"p"},"production-grade")," app."),(0,r.kt)("p",null,"There is three small issues at the moment: "),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Our app does not yet do too much - we will fix that later in the lecture"),(0,r.kt)("li",{parentName:"ol"},"Our app uses a non-production grade authentication - this is fine for now, we learn an ",(0,r.kt)("a",{parentName:"li",href:"/docs/guiding-thread#profiles"},(0,r.kt)("inlineCode",{parentName:"a"},"E")," profile"),", we draw the line here for now and will improve it later, for now it is secure enough"),(0,r.kt)("li",{parentName:"ol"},"Our app is not conveniently deployable - we also want to produce an usable artifact \ud83d\udc47\ud83c\udffc")),(0,r.kt)("h2",{id:"building-docker"},"Building docker"),(0,r.kt)("p",null,"In the lecture today we have refreshed our ",(0,r.kt)("a",{parentName:"p",href:"/docs/tools/docker"},"docker")," knowledge. Time to put it under test."),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Hint"),": You need a ",(0,r.kt)("inlineCode",{parentName:"p"},"build"),"(built) app for the image. The build step is also explained in the tutorial linked on the next line but it should be present from ",(0,r.kt)("a",{parentName:"p",href:"/docs/expectations#-gradle"},"past lecture ",(0,r.kt)("em",{parentName:"a"},"BSY")," (gradle)"),"."),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Task")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},(0,r.kt)("em",{parentName:"p"},"Dockerize")," your application, either you figure it our after todays lesson or use the ",(0,r.kt)("a",{parentName:"p",href:"https://spring.io/guides/gs/spring-boot-docker/"},"official tutorial"),"."),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Sample solution"),(0,r.kt)("a",{href:"https://github.com/nds-swe/spring-starter/releases/tag/0.1.1",target:"_blank"},"Sample solution (check the Dockerfile)")))),(0,r.kt)("p",null,"Some minor remarks:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The tutorial also optimizes build performance in the last step, we skip that for now"),(0,r.kt)("li",{parentName:"ul"},"You should use a separate user to run the spring app, it increases the security even further - how you can do that is described in the tutorial and shown in the sample solution.")),(0,r.kt)("h2",{id:"push"},"Push"),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Task")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Push the result to a GitHub repository of your choice and hand in the repository URL via a comment on ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/nds-swe/spring-starter/discussions/2"},"this discussion"),"."))),(0,r.kt)("h2",{id:"dependabot"},"Dependabot"),(0,r.kt)("p",null,"If you made it that far in time, congratulations \ud83c\udf89. If not, this task is optional or for the interested ones."),(0,r.kt)("p",null,"It is very tedious to keep dependencies up to date. We could implement some algorithm to solve that... ... ... ... NO! ",(0,r.kt)("a",{parentName:"p",href:"/docs/theory/principles#do-not-repeat"},"DRY"),"! Someone must have done that! ",(0,r.kt)("strong",{parentName:"p"},"Correct"),"."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://dependabot.com/"},"Dependabot")," is capable of maintaining our dependencies for us! Pay it - the bot - a visit (here is the ",(0,r.kt)("a",{parentName:"p",href:"https://dependabot.com/#how-it-works"},"how to"),") and add it to your project!"),(0,r.kt)("p",null,"Here are its ",(0,r.kt)("a",{parentName:"p",href:"https://docs.github.com/en/code-security/supply-chain-security/enabling-and-disabling-version-updates"},"official docs"),"!"),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Here is a sample solution \ud83d\ude09"),(0,r.kt)("a",{href:"https://github.com/nds-swe/spring-starter/releases/tag/0.1.1",target:"_blank"},"Sample solution (check the .github folder)")))}m.isMDXComponent=!0},8602:function(e,t,a){t.Z=a.p+"assets/files/start-spring-io-ff0573577f95047bd9ff0bc0b7e77043.png"},9206:function(e,t,a){t.Z=a.p+"assets/images/deprecated-method-a8e50263a3a94bdec51ee686ebf968a3.png"},6574:function(e,t,a){t.Z=a.p+"assets/images/start-spring-io-ff0573577f95047bd9ff0bc0b7e77043.png"}}]);